#!/bin/bash

if ! command -v brew &> /dev/null; then
  echo "Brew is not installed. Installing now..."
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
  {{- if ne .chezmoi.os "darwin" }}
  eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
  {{- end }}
else
  echo "Brew is already installed. Skipping installation."
fi

# Brewfile hash: {{ includeTemplate "dot_Brewfile.tmpl" . | sha256sum }}
brew bundle install --no-lock --cleanup --no-upgrade --global

brew cleanup --prune=all
